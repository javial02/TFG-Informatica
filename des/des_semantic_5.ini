%
% Error 2: Unnecessary Distinct
create or replace table t(a int primary key, b int);
create or replace table s(c int primary key, d int);
%
select distinct a from t;
select distinct * from t,s where t.a=s.c;
select distinct t.a,s.d from t,s where t.a=s.c;
%
create or replace table t(a int primary key);
select distinct a from t group by a;
%
create or replace table t(a int, b int);
select distinct a,b from t group by a,b;
%  
create or replace table t(a int candidate key, b int, c int);
select distinct c from t where a = b and b = c;
%
% Error 8: Tautological or inconsistent condition
create table department (deptno char(3) primary key, deptname varchar(36) not null); 
create table employee (empno char(6) primary key, firstname varchar(12), lastname varchar(15) not null, workdept char(3), foreign key (workdept) references department(deptno));
%
select deptno, deptname from department left join employee on workdept = deptno where lastname is null order by deptno;
select deptno, deptname from department right join employee on workdept = deptno where deptname is null order by deptno;
select deptno, deptname from department full join employee on workdept = deptno where deptname is null order by deptno;
%
% Error 18: Unnecessary GROUP BY in EXISTS subquery
create or replace table t (a int, b int, c int); 
create or replace table s (a int, b int, c int); 
create or replace table u (a int, b int); 
% 
select * from t where exists (select 1 from s group by b);
select * from t where exists (select 1 from s where s.a = t.a group by s.b);
select * from t where exists (select 1 from s where s.a = t.a group by s.c);
select * from t where exists (select 1 from s where s.b = t.b group by s.a);
select * from t where exists (select 1 from s join u on u.a = s.a where t.b = s.b group by s.a);
% Positive cases
select * from t where exists (select 1 from s where s.a = t.a group by s.a having count(*) > 1);
select a, count(*) from t group by a;
%
% Error 19: GROUP BY with singleton groups
create or replace table t(a int primary key, b int);
create or replace table s(a int, b int, primary key (a, b));
create or replace table t(a int candidate key, b int);
create or replace table s(a int, b int, candidate key (a, b));
create or replace table t(a int primary key, b string determined by a);
%
select a from t group by a;
select a, b from s group by a, b;
select a from t group by a;
select a, b from s group by a, b;
select a, b from t group by a, b;
select a, count(*) from t group by a;  
select a, max(b) from t group by a;   
% Positive cases
select a, count(*) from u group by a;  
select a, max(b) from u group by a;    
select b, count(*) from t group by b;  
select c, sum(b) from u group by c;    
% New cases
create or replace table t(a int primary key, b string determined by a, c int determined by b);
select a, b from t group by a, b, c;
%
create or replace table t(a int, b int determined by a);
select a, b from t group by a, b;
%
create or replace table t(a int primary key, b int)
select a, b from t where a = b group by a, b;
%
% Error 20: GROUP BY with only a single group
create or replace table t(a int, b int);
%
create or replace table t(a int, b int);
%
select count(a) from t where a = 3 group by a;
select 1 from t where a = 3 group by a;
% Positive cases
select a from t where a = all (select b from t) group by a;  
select a from t where a = (select b from t) group by a;      
%
% Error 21: Unnecessary GROUP BY attribute
create table j(a int, b int);
select a from j where a = b group by a, b;
% Positive case
select a from j where a = b group by a, b having b = 1;
%
create or replace table t(a int primary key, b string determined by a);
select a from t group by a, b;
% Positive case
select a, b from t group by a, b;
%
create or replace table t(a int primary key, b int determined by a, c int determined by b);
select a from t group by c, a, b;
select a from t where a = c group by c, a, b;
% Positive case
select a from t group by a, b having b = 1;
%
% Error 22: GROUP BY can be replaced by DISTINCT
create or replace table t(a int, b int);
create or replace table s(a int, b int);
%
select a, b from t group by a, b;
select a, b from s group by a, b;
select a, b from t where a > 10 group by a, b;
select a from t group by a;
% Positive cases
select a, b from t where a > 10;
select a, b from s where b < 20;
select distinct a, b from t;
select distinct a, b from s where a > 5;
select a from t group by a having count(*) > 1;
%
% Error 24: Unnecessaty ORDER BY term
create or replace table t(a int, b int);
select a from t where a = b order by a, b;
%
create or replace table t(a int primary key, b int determined by a, c int determined by b);
select a from t order by a, b;
%
create or replace table t(a int primary key, b int);
select a from t order by a, b;
%
create or replace table t(a int candidate key, b int);
select a from t order by a, b;
